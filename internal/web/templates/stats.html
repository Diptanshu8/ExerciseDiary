{{ define "stats.html" }}
</head>
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<body>
    <div class="container mt-5">
    <div class="row">
        <div class="col-8">
            <div class="card border-primary">
                <div class="card-header">HeatMap</div>
            <div class="card-body">
                <div id="heatmap">
                </div>
            </div>
            </div>
        </div>
        <div class="col-4">
            <div class="card border-primary">
                <div class="card-header">About</div>
            <div class="card-body">
            </div>
            </div>
        </div>
    </div>
    </div>
        
<script>

heat = {{ .HeatMap }};
console.log("HEAT =", heat);

function lowerData() {
    var ldata = [];
    let hdata = [];
    let arrayLength = heat.length;
    for (let i = 0 ; i < arrayLength; i++) {
        let dataLength = heat[i].Data.length;
        hdata = [];
        for (let j = 0 ; j < dataLength; j++) {
            hdata.push({
                x: heat[i].Data[j].X,
                y: heat[i].Data[j].Y
            });
        }
        ldata.push({
            name: heat[i].Name,
            data: hdata
        });
    }
    return ldata;
}
ldata = lowerData();
console.log("LDATA =", ldata);


var options = {
          series: ldata,
        chart: {
          height: 170,
          width: 850,
          type: 'heatmap',
          backgrount: '0',
        },
        fill: {
            type: 'gradient',
            opacity: 0.5,
        },
        grid: {
            show: true,
            borderColor: '#949494',
            position: 'front',
            xaxis: {
                lines: {
                    show: true
                }
            },   
            yaxis: {
                lines: {
                    show: true
                }
            },  
        },
        dataLabels: {
          enabled: false
        },
        colors: ['#03a70c'],
        // title: {
        //   text: 'Activity Chart'
        // },
        xaxis: {
            labels: {
                show: false
            }
        },
        yaxis: {
            reversed: true
        },
        tooltip: {
            enabled: true,
            x: {
                show: true,
                formatter: (value,options)=>{
                    return options.w.config.series[options.seriesIndex].data[options.dataPointIndex].x
                }
            },
            y: {
                show: false,
            },
        }
        };

var chart = new ApexCharts(document.querySelector("#heatmap"), options);

chart.render();

</script>

{{ template "footer.html" }}
{{ end }}